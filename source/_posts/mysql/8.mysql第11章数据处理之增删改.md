---
title: 8.mysql第11章数据处理之增删改
date: 2019-10-03 16:00:00
author: 𝚲𝚳𝚲
tags:   # 添加博文标签
	- mysql8.0.22
categories:   # 添加博文分类
	- mysql8.0.22




---

<h1><center>表中数据处理之增删改</center></h1>



## 1.增加一条记录

### 1.1 语句

- 





## 练习

~~~mysql
# 第11章数据处理之增删改
#创建数据库
create database IF not exists test;
#删除数据库
drop database if exists test;

# 创建数据库同时设置字符集
create database if not exists test1 character set utf8mb4;

#使用数据库
use test1;

#修改数据库
alter database test character set gbk;
# 查看指定数据库信息
show create database test;

# 查看当前mysql服务器上面，有多少数据库
show databases;

# 删除数据库
drop database if exists test;

#使用test1数据库
use test1;
# 创建表
create table empl(
    id int primary key auto_increment, # 主键约束 就包括 （非空 唯一） auto_increment自动递增
    name varchar(15) not null ,
    age int not null ,
    email varchar(10) unique , #邮件不能重复
    phone varchar(11) unique #手机号不能重复
);

# 查看表
desc empl;

#给表中插入数据
insert into empl ( name, age, email, phone)
values ('张三',15,'71@qq.com','13456789920');

insert into empl ( name, age, email, phone)
values ('张三',15,'rtwrt@qq.com','13443256789920');


desc empl;

# 修改表（修改的是表中的列）（对未创建表。的约束不能修改）
# 修改表中某个字段名
alter table empl
modify phone varchar(15) unique;

#增加列
alter table empl
add addres Varchar(75)  default '暂时未填写'; # 增加地址列，同时添加唯一约束，设置默认值


# 删除某一列
alter table empl
drop addres;

# 查询表中的数据
select * from empl;

# 删除表中的数据
delete from empl;

# 删除表
drop table empl; # 直接将整个表从数据库中删除，且不能恢复


#------------------------------DML的操作---------------------------------------------------------

# 数据处理之增删改

# 如果需要回滚数据,需要保证在DML前,进行设置:
SET AUTOCOMMIT = FALSE;


# 增加一条数据
# 1.为表的指定字段插入数据,就是在INSERT语句中只向部分字段中插入值,而其他字段的值为表定义时的默认值。
# 在 INSERT 子句中随意列出列名,但是一旦列出,VALUES中要插入的value1,....valuen需要与 column1,...columnn列一一对应。如果类型不同,将无法插入,并且MySQL会产生错误。

create table student(
    id int primary key auto_increment,
    name varchar(15) not null ,
    class varchar(10) not null ,
    num int  unique #学号可以为空
);

select * from student;

# 1.插入数据，字段和值要匹配
insert into student( name, class, num)
values ('小明','一年级三班',103015);

insert into student( name, class)
values ('小明','一年级三班');

# 2.同时插入多条记录
/**
  INSERT INTO table_name
VALUES
(value1 [,value2, ..., valuen]),
(value1 [,value2, ..., valuen]),
......
(value1 [,value2, ..., valuen]);

  或者
  INSERT INTO table_name(column1 [, column2, ..., columnn])
VALUES
(value1 [,value2, ..., valuen]),
(value1 [,value2, ..., valuen]),
......
(value1 [,value2, ..., valuen]);
 */

/**
  小结：
  VALUES 也可以写成 VALUE ,但是VALUES是标准写法。
    字符和日期型数据应包含在单引号中。
 */





/**
  1.3 方式2:将查询结果插入到表中
INSERT还可以将SELECT语句查询的结果插入到表中,此时不需要把每一条记录的值一个一个输入,只需
要使用一条INSERT语句和一条SELECT语句组成的组合语句即可快速地从一个或多个表中向一个表中插入
多行。
基本语法格式如下:

INSERT INTO 目标表名
(tar_column1 [, tar_column2, ..., tar_columnn])
SELECT
(src_column1 [, src_column2, ..., src_columnn])
FROM 源表名
[WHERE condition]
 */
/**
  一个同时插入多行记录的INSERT语句等同于多个单行插入的INSERT语句,但是多行的INSERT语句
在处理过程中 效率更高 。因为MySQL执行单条INSERT语句插入多行数据比使用多条INSERT语句
快,所以在插入多条记录时最好选择使用单条INSERT语句的方式插入。
 */

# 复制一张表过来(只要字段，不要数据)
create table emp2
select * from atguigudb.employees where 1=2;

alter table emp2
modify salary int;

desc emp2;
select * from emp2;

# emp2数据表，快速插入数据(将employees)表中数据全部都插入进来了
insert into emp2
select * from atguigudb.employees ;

INSERT INTO emp2(employee_id, last_name,email ,salary,hire_date ,commission_pct)
SELECT employee_id, last_name, email,hire_date,salary, commission_pct
FROM
 atguigudb.employees
WHERE
 job_id LIKE '%REP%';

select * from student;


#更改数据,一次更新多条数据
update student
set class='五年级一班',num='501025'
where id=2;
select * from student;

rollback ; # 回滚（只能回滚到上一次提交之后）

select * from student;

#----------------------------------------------

# 删除一条数据
delete from student
where id=1;

select * from student;

# 清空表中的所有数据
delete from student;

~~~

## DDL 和 DML综合案列

```mysql

#------------DDL和DML的综合练习----------------------------
#练习
# 1.创建数据库
create database if not exists test01_library character set utf8mb4;
#查看数据库信息
show create database test01_library;

#使用数库
use test01_library;
# 2.创建表 books
create table books(
    id int primary key auto_increment comment '书编号',#主键自增
    name varchar(50) not null unique comment '书名',
    authors varchar(100) not null comment '作者',
    price float not null comment '价格',
    pubdate year comment '出版日期 格式 YYYY',
    note varchar(100) comment '说明',
    num int not null comment '库存'
);

desc books;

select * from books;

# 向books表中插入记录
# # 1)不指定字段名称,插入第一条记录
insert into books
values (1,'成功学','张三',65.80,2024,'这是一部现代哲学史诗',500);
# 2)指定所有字段名称,插入第二记录
insert into books (id, name, authors, price, pubdate, note, num)
values (2,'前行者','李四',99.2,2001,'前进的道路总有坎坷，只有强者才能勇攀高峰',800);
# 3)同时插入多条记录(剩下的所有记录)
insert into books(name, authors, price, pubdate, note, num)
values ('铜墙铁壁','王伟',99.2,2001,'铜墙铁壁是保护色',264),
       ('路途','增益',99.2,2001,'路途犹如迷途，人生之道就在其中',545),
       ('高高兴兴','王晓燕',99.2,2001,'高高兴兴干好每一件事',851);


insert into books(name, authors, price, pubdate, note, num)
values ('Tal of AAA','Dickes',23,1995,'novel',11),
       ('EmmaT','Jane lura',35,1993,'joke',22),
       ('Story of Jane','Jane Tim',40,2001,'novel',0),
       ('Lovey Day','George Byron',20,2005,'novel',30),
       ('Old land','Honore Blade',30,2010,'law',0),
       ('The Battle','Upton Sara',30,1999,'medicine',40),
       ('Rose Hood','Richard haggard',28,2008,'cartoon',28);

select * from books where note='novel';

# 4、将小说类型(novel)的书的价格都增加5。
update books set price=price+5 where note='novel';

# 5、将名称为EmmaT的书的价格改为40,并将说明改为drama。
update books
set price=40,note='drama'
where name='EmmaT';

select * from books where name='EmmaT';

# 6、删除库存为0的记录。
delete from books where num='0';
select * from books;

# 7、统计书名中包含a字母的书

select *
from books
where name like '%a%';

# 8、统计书名中包含a字母的书的数量和库存总量
select count(1) , sum(num)
from books
where name like '%a%';

# 9、找出“novel”类型的书,按照价格降序排列
select * from books
where note='novel'
order by price desc;

# 10、查询图书信息,按照库存量降序排列,如果库存量相同的按照note升序排列
select *
from books
order by num desc , note asc;

# 11、按照note分类统计书的数量
select note, count(1)
from books
group by note;

# 12、按照note分类统计书的库存量,显示库存量超过30本的

select note,sum(num)
from books
group by note
having sum(num)>30;

# 13、查询所有图书,每页显示5本,显示第二页

select * from books;

select * from books
limit 5,5;
# 14、按照note分类统计书的库存量,显示库存量最多的
select note,sum(num)
from books
group by note
order by sum(num) desc
limit 0,1;

# 15、查询书名达到10个字符的书,不包括里面的空格
select * from books

where char_length(replace(name,' ',''))>=10;



# 16、查询书名和类型,其中note值为novel显示小说,law显示法律,medicine显示医药,cartoon显示卡通,joke显示笑话
select name as '书名',
       case note when 'novel'       then '小说'
                 when 'law'         then '法律'
                 when  'medicine'   then '医药'
                 when 'cartoon'     then '卡通'
                 when 'joke'        then '笑话'
       else '普通书籍'
       end as '类型'
from books;

# 17、查询书名、库存,其中num值超过30本的,显示滞销,大于0并低于10的,显示畅销,为0的显示需要无货
select * from books;
select name , num , case  when num>30 then '滞销'
                             when num>0 and num<10 then '畅销'
                             when num=0 then '需要补货'
                             else '正常'
                             end as '状态'
from books;

# 18、统计每一种note的库存量,并合计总量
# 生成汇总行 WITH ROLLUP
select IFNULL(note,'合计库存总量') note,sum(num)
from books
group by note WITH ROLLUP;

# 19、统计每一种note的数量,并合计总量
select IFNULL(note,'合计总量'), count(note)
from books
group by note with rollup ;


# 20、统计库存量前三名的图书
select * from books
order by num desc
limit 0,3;


# 21、找出最早出版的一本书
select *
from books
order by pubdate
limit 0,1;


# 22、找出novel中价格最高的一本书
select * from books
where note='novel'
order by price desc
limit 0,1;


# 23、找出书名中字数最多的一本书,不含空格
SELECT * FROM books ORDER BY CHAR_LENGTH(REPLACE(name,' ','')) DESC LIMIT 0,1;
```



## 课后练习题

```mysql

#-----------------------数据处理之增删改课后练习题------------------------------------------------------------
#1. 创建数据库dbtest11
#2. 运行以下脚本创建表my_employees
#3. 显示表my_employees的结构
#4. 向my_employees表中插入下列数据
/**
ID  FIRST_NAME  LAST_NAME   USERID  SALARY
1   patel   Ralph   Rpatel  895
2   Dancs   Betty   Bdancs  860
3   Biri    Ben Bbiri   1100
4   Newman  Chad    Cnewman 750
5   Ropeburn    Audrey  Aropebur1550
 */
#5. 向users表中插入数据
/**
1 Rpatel 10
2 Bdancs 10
3 Bbiri 20
4 Cnewman 30
5 Aropebur 40
 */
#6. 将3号员工的last_name修改为“drelxer”
#7. 将所有工资少于900的员工的工资修改为1000
#8. 将userid为Bbiri的user表和my_employees表的记录全部删除
#9. 删除my_employees、users表所有数据
#10. 检查所作的修正
#11. 清空表my_employees


```







---


----

© 版权声明

<escape>

<div>
    <h3 align="center"  style="color: brown;" >版权声明</h3>
    <table>
   		<tr>
    		<ol>
				<li>本网站名称：𝚲𝚳𝚲</li>
				<li>𝚲𝚳𝚲提供的资源仅供您个人用于非商业性目的。</li>
				<li>本站文章部分内容可能来源于网络，仅供大家学习与参考，如有侵权，请联系我进行删除处理。</li>
				<li>本站一切资源不代表本站立场，并不代表本站赞同其观点和对其真实性负责。</li>
        		<li>本站一律禁止以任何方式发布或转载任何违法的相关信息，访客发现请举报</li> 
        		<li>本站资源大多存储在云盘，如发现链接失效，请联系我，我会第一时间更新。</li>
        		<li>本站强烈打击盗版/破解等有损他人权益和违法作为，请支持正版！</li>  
			</ol>
		</tr>
	</table>
</div>






</escape>

----









